<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatKit Test</title>
    <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js"></script>
</head>
<body>
    <h1>ChatKit Minimal Test</h1>
    <div style="border: 2px solid red; padding: 20px;">
        <openai-chatkit id="chat" style="width: 400px; height: 600px; display: block; border: 1px solid blue;"></openai-chatkit>
    </div>

    <script>
        setTimeout(() => {
            const chatkit = document.getElementById('chat');
            console.log('ChatKit element:', chatkit);
            console.log('Has setOptions?', typeof chatkit.setOptions);
            
            chatkit.setOptions({
                api: {
                    async getClientSecret() {
                        const response = await fetch('https://chatkit-agent-server.onrender.com/api/chatkit/session', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' }
                        });
                        const data = await response.json();
                        console.log('Got client_secret:', data.client_secret.substring(0, 20) + '...');
                        return data.client_secret;
                    }
                }
            });
            
            console.log('ChatKit configured!');
            
            // Check every 2 seconds
            setInterval(() => {
                console.log('ChatKit check:', {
                    shadowRoot: !!chatkit.shadowRoot,
                    children: chatkit.shadowRoot ? chatkit.shadowRoot.children.length : 0,
                    display: window.getComputedStyle(chatkit).display,
                    visibility: window.getComputedStyle(chatkit).visibility
                });
            }, 2000);
        }, 1000);
    </script>
</body>
</html>
